{% extends "base.html" %}
{% block content %}
<div class="card p-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">Quản Lý Tồn Kho</h3>
    <div class="btn-group">
      <a href="{{ url_for('store_issue') }}" class="btn btn-outline-primary btn-sm">
        <i class="bi bi-box-arrow-up"></i> Xuất Kho
      </a>
      <a href="{{ url_for('store_return') }}" class="btn btn-outline-secondary btn-sm">
        <i class="bi bi-box-arrow-in-down"></i> Nhập Kho
      </a>
    </div>
  </div>

  <p class="text-muted">Cập nhật số lượng tồn kho cho tất cả thiết bị</p>

  <form method="post" id="inventory-form">
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th style="width: 60%">Tên Thiết Bị</th>
            <th style="width: 40%">Tồn Kho</th>
          </tr>
        </thead>
        <tbody>
          {% for equipment in equipments %}
          <tr>
            <td>
              <strong>{{ equipment.name }}</strong>
            </td>
            <td>
              <input 
                type="number" 
                name="quantity_{{ equipment.id }}" 
                value="{{ equipment.available_quantity or 0 }}" 
                class="form-control" 
                min="0"
                style="max-width: 150px;">
            </td>
          </tr>
          {% endfor %}
          {% if not equipments %}
          <tr>
            <td colspan="2" class="text-center text-muted">
              Chưa có thiết bị nào trong hệ thống
            </td>
          </tr>
          {% endif %}
        </tbody>
      </table>
    </div>

    {% if equipments %}
    <div class="d-flex justify-content-end gap-2 mt-3">
      <button type="button" class="btn btn-secondary" onclick="window.history.back()">Hủy</button>
      <button type="submit" class="btn btn-primary">
        <i class="bi bi-save"></i> Lưu Tất Cả
      </button>
    </div>
    {% endif %}
  </form>
</div>

<script>
// Auto-select all text in input when focused for easy editing
document.querySelectorAll('input[type="number"]').forEach(input => {
  input.addEventListener('focus', function() {
    this.select();
  });
});

// Keyboard shortcuts
document.addEventListener('keydown', function(e) {
  // Ctrl+S or Cmd+S to save
  if ((e.ctrlKey || e.metaKey) && e.key === 's') {
    e.preventDefault();
    document.getElementById('inventory-form').submit();
  }
});
</script>
{% endblock %}
